from pymongo import MongoClient
from pprint import pprint
client = MongoClient('localhost', 27017)
db = client['test_database']
data = {
    'link': ['https://taganrog.hh.ru/vacancy/40275700?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40488814?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40345993?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40451442?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40229754?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40217030?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40472983?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40547097?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40441557?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40539768?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40266254?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40508491?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40542320?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40458487?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40393150?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40329718?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40458515?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40458972?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40438277?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40479254?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40502175?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40354683?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40121956?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40167071?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40334658?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40509904?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40025237?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40493919?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40537454?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/39983163?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40211199?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40447184?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40292035?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40434382?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40464818?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/39391670?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40434185?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40529243?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40469828?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40275369?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/39998376?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40436113?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/39960713?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40457126?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40424094?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40057393?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40497444?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40449901?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40386276?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          'https://taganrog.hh.ru/vacancy/40434207?query=%D0%B0%D1%81%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BD%D1%82%20HR',
          '/vakansii/hr-assistent-34791180.html',
          '/vakansii/pomoschnik-hr-menedzhera-34225508.html',
          '/vakansii/assistent-menedzhera-po-podboru-personala-34848639.html',
          '/vakansii/menedzher-35079201.html',
          '/vakansii/assistent-menedzhera-po-personalu-34964056.html',
          '/vakansii/assistent-menedzhera-po-podboru-personala-34694988.html',
          '/vakansii/pomoschnik-menedzhera-po-podboru-personala-35090752.html',
          '/vakansii/assistent-menedzhera-po-podboru-personala-35057634.html',
          '/vakansii/menedzher-po-personalu-31888164.html',
          '/vakansii/pomoschnik-menedzhera-po-podboru-personala-31575611.html',
          '/vakansii/assistent-menedzhera-po-personalu-31630982.html',
          '/vakansii/stazher-hr-menedzher-33790595.html',
          '/vakansii/assistent-menedzhera-po-podboru-personala-35050919.html',
          '/vakansii/pomoschnik-rukovoditelya-33507409.html',
          '/vakansii/assistent-menedzhera-po-podboru-personala-34978230.html',
          '/vakansii/assistent-menedzhera-po-podboru-personala-35099590.html',
          '/vakansii/assistent-menedzhera-po-podboru-personala-34621841.html',
          '/vakansii/stazher-v-hr-otdel-34969072.html',
          '/vakansii/pomoschnik-menedzhera-po-podboru-personala-34915439.html',
          '/vakansii/pomoschnik-menedzhera-po-podboru-personala-34453404.html'],
    'name_vacansy': ['Помощник рекрутера',
                  'Ассистент менеджера по подбору персонала',
                  'Ассистент HR-менеджера',
                  'Ассистент HR-менеджера',
                  'HR-специалист',
                  'Ассистент отдела HR',
                  'Заместитель директора по персоналу',
                  'Специалист по подбору персонала в розничную сеть',
                  'Младший специалист по подбору персонала (удалённо)',
                  'Стажер (ассистент отдела)',
                  'HR Development Manager / Ассистент отдела развития '
                  'персонала',
                  'Ассистент менеджера по подбору персонала / Рессечер / '
                  'Помощник HR',
                  'Ассистент менеджера по подбору персонала',
                  'Помощник менеджера по подбору персонала',
                  'Ассистент менеджера по персоналу',
                  'HR-ассистент (с функциями офис-менеджера)',
                  'Ассистент отдела обучения (стажер)',
                  'Помощник HR - менеджера',
                  'Ассистент HR-менеджера',
                  'Помощник руководителя / Личный помощник (HR - менеджер, '
                  'удаленно)',
                  'Ассистент руководителя / Бизнес-ассистент',
                  'Ассистент менеджера по персоналу',
                  'Ассистент (помощник) отдела маркетинга',
                  'HR Assistant',
                  'HR менеджер (Ассистент HR-менеджера)',
                  'HR менеджер-рекрутер / помощник руководителя по работе с '
                  'персоналом',
                  'Ресёчер \\ Помощник HR-менеджера',
                  'Помощник HR-менеджера',
                  'Помощник менеджера по подбору персонала',
                  'Ассистент отдела подбора и развития персонала',
                  'Ассистент менеджера по персоналу',
                  'Ассистент менеджера по подбору персонала',
                  'Помощник / ассистент отдела по подбору персонала',
                  'Помощник в сферу HR',
                  'Помощник в сферу HR',
                  'Личный помощник / HR-менеджер',
                  'Помощник в сферу HR',
                  'Помощник менеджера по персоналу',
                  'Помощник в сферу HR',
                  'Помощник в сферу HR',
                  'Помощник менеджера по персоналу',
                  'Менеджер по подбору персонала / Ассистент рекрутера',
                  'HR/помощник в отдел персонала (Верхние Печеры)',
                  'Помощник менеджера по персоналу (ресечер)',
                  'Помощник менеджера по персоналу',
                  'Помощник (HR)',
                  'Помощник менеджера по персоналу',
                  'Помощник менеджера по подбору персонала',
                  'Помощник в сферу HR',
                  'Помощник в сферу HR',
                  'HR-ассистент, специалист по подбору персонала в крупную '
                  'компанию',
                  'Помощник HR-менеджера / Ресечер',
                  'Ассистент менеджера по подбору персонала',
                  'Менеджер / Ассистент менеджера по работе с населением',
                  'Ассистент менеджера по персоналу',
                  'Ассистент менеджера по подбору персонала (массовый подбор)',
                  'Помощник менеджера по подбору персонала',
                  'Ассистент менеджера по подбору персонала',
                  'Менеджер по персоналу / Рекрутер / Помощник HR',
                  'Помощник менеджера по подбору персонала',
                  'Ассистент менеджера по персоналу',
                  'Стажер HR-менеджер / Психолог',
                  'Ассистент менеджера по подбору персонала / Рекрутер',
                  'Помощник руководителя / Менеджер по персоналу',
                  'Ассистент менеджера по подбору персонала / Ресечер',
                  'Ассистент менеджера по подбору персонала',
                  'Ассистент менеджера по подбору персонала',
                  'Стажер в HR отдел',
                  'Помощник менеджера по подбору персонала',
                  'Помощник менеджера по подбору персонала'],
    'pay': [['20000', '30000 ', 'руб.'],
         ['40000', '60000 ', 'руб.'],
         [' 145000', '0', ' KZT'],
         ['0', '0', ''],
         ['30000', '150000', ' KGS'],
         ['100000', '150000', ' KZT'],
         ['5500', '6000', 'бел. руб.'],
         ['0', '0', ''],
         ['15000', '25000 ', 'руб.'],
         ['15000', '15000 ', 'руб.'],
         ['0', '0', ''],
         [' 25000 ', '0', 'руб.'],
         [' 25000 ', '0', 'руб.'],
         [' 40000 ', '0', 'руб.'],
         [' 25000 ', '0', 'руб.'],
         ['0', '0', ''],
         ['0', '0', ''],
         [' 23000 ', '0', 'руб.'],
         ['0', '0', ''],
         ['25000', '50000 ', 'руб.'],
         [' 20000 ', '0', 'руб.'],
         ['30000', '30000 ', 'руб.'],
         ['2000', '30000 ', 'руб.'],
         ['0', '0', ''],
         ['30000', '45000 ', 'руб.'],
         ['36000', '55000 ', 'руб.'],
         ['24000', '35000 ', 'руб.'],
         [' 35000 ', '0', 'руб.'],
         [' 25000 ', '0', 'руб.'],
         ['0', ' 18000 ', 'руб.'],
         ['25000', '40000 ', 'руб.'],
         ['35000', '35000 ', 'руб.'],
         ['35000', '35000 ', 'руб.'],
         ['20000', '30000 ', 'руб.'],
         ['20000', '30000 ', 'руб.'],
         [' 25000 ', '0', 'руб.'],
         ['20000', '30000 ', 'руб.'],
         ['20000', '30000 ', 'руб.'],
         ['20000', '30000 ', 'руб.'],
         ['20000', '30000 ', 'руб.'],
         ['30000', '35000 ', 'руб.'],
         ['30000', '55000 ', 'руб.'],
         ['24022', '32000 ', 'руб.'],
         ['25000', '30000 ', 'руб.'],
         [' 26000 ', '0', 'руб.'],
         ['20000', '30000 ', 'руб.'],
         ['20000', '20000 ', 'руб.'],
         [' 40000 ', '0', 'руб.'],
         ['20000', '30000 ', 'руб.'],
         ['20000', '30000 ', 'руб.'],
         ['0', '0', 'По договорённости'],
         ['55000', '0', 'руб./месяц'],
         ['0', '36000', 'руб./месяц'],
         ['70000', '0', 'руб./месяц'],
         ['45000', '0', 'руб./месяц'],
         ['25500', '0', 'руб./месяц'],
         ['0', '0', 'руб./месяц'],
         ['0', '0', 'руб./месяц'],
         ['35000', '0', 'руб./месяц'],
         ['35000', '0', 'руб./месяц'],
         ['0', '0', 'По договорённости'],
         ['0', '40000', 'руб./месяц'],
         ['0', '0', 'руб./месяц'],
         ['0', '0', 'По договорённости'],
         ['0', '30000', 'руб./месяц'],
         ['20000', '0', 'руб./месяц'],
         ['30000', '0', 'руб./месяц'],
         ['0', '0', 'По договорённости'],
         ['35000', '0', 'руб./месяц'],
         ['35000', '0', 'руб./месяц']],
     'sites': ['https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://taganrog.hh.ru/search/vacancy',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/',
           'https://www.superjob.ru/vacancy/search/']
}




collection = db.test_collection
inventory = db.inventory


#задание 1
#  не делал отсев  по уникальности нет в залании, сам не догодался
def add_data_all(data):
    i = len(data['name_vacansy'])
    all=list()
    while i > 0:
        i -= 1
        all.append({
            'name_vacansy':data['name_vacansy'][i],
            'min_pay': int(data['pay'][i][0]),
            'max_pay':int(data['pay'][i][1]),
            'val':(data['pay'][i][2]),
            'link': data['link'][i],
            'sites': data['sites'][i]
        })
    inventory.insert_many(all)
    pass
add_data_all(data)

#задание 2

def find_data_pass(data:int):
    return inventory.find({'$or': [{'max_pay': {'$gt': data}}, {'min_pay': {'$gt':data}}]})
pprint(list(find_data_pass(150000)))
#pprint(inventory.find({ $or: [{'max_pay': 0},{'min_pay': 0}]}))
i = 10000
#pprint((inventory.find({'max_pay':3})))
#pprint(list(inventory.find({'min_pay':{'$gt': i}})))


def add_data(data):
    if len(list(inventory.find({'link': data['link']}))) == 0:
        inventory.insert_one(data)
    pass
